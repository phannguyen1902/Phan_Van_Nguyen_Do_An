<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <meta
            name="viewport"
            content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta name="author" content="Untree.co"/>
    <meta name="description" content=""/>
    <meta name="keywords" content="bootstrap, bootstrap4"/>

    <!-- Bootstrap CSS -->
    <link href="/../../images/WingMan-black.png" rel="icon">
    <link
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
            rel="stylesheet"
    />
    <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css'>
    <link href="/../css/customer/tiny-slider.css" rel="stylesheet"/>
    <link href="/../css/customer/style.css" rel="stylesheet"/>

    <link rel="stylesheet" type="text/css" href="./vendor/bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pretty-checkbox@3.0/dist/pretty-checkbox.min.css"/>
    <link rel="stylesheet" type="text/css" href="/../css/customer/user/main.css"/>
    <link rel="stylesheet" type="text/css" href="/../css/customer/user/except-home-page.css"/>
    <link rel="stylesheet" type="text/css" href="/../css/customer/user/account.css"/>
    <link rel="stylesheet" type="text/css" href="/../css/customer/user/account-setting.css"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <title>
        Haven
    </title>
</head>
<!-- Start Header/Navigation -->
<nav class="custom-navbar navbar navbar navbar-expand-md navbar-dark bg-dark" arial-label="Furni navigation bar">
    <div class="container">
        <a class="navbar-brand" th:href="@{/haven/trang-chu}">
            <img th:src="@{/images/wingman.png}"
                 style="height: 50px; width: 50px;">
            <a class="navbar-brand"
               th:href="@{/haven/trang-chu}">Haven<span>.</span></a></a>

        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsFurni"
                aria-controls="navbarsFurni" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarsFurni">
            <ul class="custom-navbar-nav navbar-nav ms-auto mb-2 mb-md-0">
                <li><a class="nav-link" th:href="@{/haven/trang-chu}">Trang chủ</a></li>
                <li>
                    <a class="nav-link" th:href="@{/haven/cua-hang}">Sản phẩm</a>
                </li>
                <li><a class="nav-link" th:href="@{/haven/dich-vu}">Dịch vụ</a></li>
<!--                <li><a class="nav-link" th:href="@{/wingman/thong-tin}">Thông tin</a></li>-->
<!--                <li><a class="nav-link" th:href="@{/wingman/lien-he}">Liên hệ</a></li>-->
                <li><a class="nav-link" th:href="@{/haven/tra-cuu-don-hang}">Tra cứu đơn hàng</a></li>

            </ul>
            <ul class="custom-navbar-cta navbar-nav mb-2 mb-md-0 ms-5">
                <li>
                    <div class="dropdown show" style="padding-top: 5px">
                        <a href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true"
                           aria-expanded="false">
                            <img src="/../images/user.svg">
                        </a>
                        <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                            <a class="dropdown-item" href="'/haven/tai-khoan-cua-toi'">Tài khoản của tôi</a>
                            <a class="dropdown-item" th:href="'/haven/hoa-don-cua-toi'">Đơn mua</a>
                            <a class="dropdown-item" th:href="'/logout'">Đăng xuất</a>
                        </div>
                    </div>
                </li>
                <li><a class="nav-link" th:href="@{/haven/cart}"><img src="/../images/cart.svg"
                                                                        style="padding-bottom: 5px"></a>
                </li>
                <style>
                    /* Dropdown Button */
                    /* Ẩn dropdown menu mặc định */
                    .dropdown-menu {
                        display: none;
                        opacity: 0;
                        position: absolute;
                        top: 100%; /* Hiển thị menu bên dưới button */
                        background-color: #fff; /* Màu nền của dropdown */
                        transition: opacity 0.3s ease; /* Hiệu ứng mượt mà cho opacity */
                    }

                    /* Hiển thị dropdown menu khi hover vào .dropdown */
                    .dropdown:hover .dropdown-menu {
                        display: block;
                        opacity: 1;
                    }

                    /* Hiệu ứng transition khi hiển thị dropdown */
                    .dropdown-menu {
                        transform: translateY(-10px); /* Di chuyển dropdown lên trên */
                        transition: transform 0.3s ease, opacity 0.3s ease;
                    }

                    .dropdown:hover .dropdown-menu {
                        transform: translateY(0); /* Đặt lại vị trí ban đầu */
                    }

                    .dropdown-toggle {
                        cursor: pointer;
                        padding: 0;
                        border: none;
                        background: transparent;
                        outline: none;
                        height: 100%; /* Đặt chiều cao của dropdown button là 100% */
                    }

                    /* Dropdown Menu */
                    .dropdown-menu {
                        width: auto;
                        box-shadow: none;
                    }

                    /* Dropdown Items */
                    .dropdown-item {
                        display: block;
                        width: 100%;
                        box-sizing: border-box;
                        text-align: left;
                    }

                    /* Cart Icon */
                </style>
            </ul>

        </div>
    </div>
</nav>
<body>
<main>
    <div class="main-content-wrapper container">
        <div th:if="${param.success}">
            <div class="alert alert-info" id="success-alert">Success!</div>
        </div>
        <div th:if="${errorTen}" class="alert alert-danger" id="err">
            <p th:text="${errorTen}"></p>
        </div>

        <script th:inline="javascript">
            /* Đặt thời gian hiển thị và ẩn thông báo sau 5 giây */
            setTimeout(function () {
                var successAlert = document.getElementById('success-alert');
                if (successAlert) {
                    successAlert.style.display = 'none';
                }
            }, 5000); // 5 giây (5000 milliseconds)
            setTimeout(function () {
                var successAlert = document.getElementById('err');
                if (successAlert) {
                    successAlert.style.display = 'none';
                }
            }, 5000); // 5 giây (5000 milliseconds)
        </script>
        <div class="row">
            <div class="col-lg-3">
                <div class="left-sidebar">

                    <div class="break-line"></div>
                    <div class="nav-sidebar">
                        <a class="account nav-item" th:href="'/haven/thong-tin-cua-toi'">Thông Tin Của Tôi</a>
                        <a class="selling-buying-products nav-item" th:href="'/haven/hoa-don-cua-toi'">Đơn Hàng
                            Mua</a>
                        <a class="btn btn-primary black-btn sign-out-btn" th:href="'/logout'">Đăng xuất</a>
                    </div>
                </div>
            </div>
            <div class="col-lg-9 main-content-wrapper">
                <div class="main-content">
                    <div class="nav-tab">
                        <ul class="nav nav-pills" id="pills-tab" role="tablist">
                            <li class="nav-item">
                                <a class="nav-link active" id="profile-setting-tab" data-toggle="pill"
                                   href="#profile-setting" role="tab" aria-controls="profile-setting"
                                   aria-selected="true">Hồ sơ tài khoản</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="address-setting-tab" data-toggle="pill" href="#address-setting"
                                   role="tab" aria-controls="address-setting" aria-selected="false">Địa chỉ của tôi</a>
                            </li>
                        </ul>
                    </div>
                    <div class="tab-content" id="pills-tabContent">
                        <!-- profile-setting Section-->
                        <div class="tab-pane fade show active" id="profile-setting" role="tabpanel"
                             aria-labelledby="profile-setting-tab">
                            <!-- Item-->
                            <form th:action="@{/haven/update}" method="post" th:object="${khachHang}"
                                  class="setting-box">
                                <input type="hidden" th:field="*{id}">
                                <div class="full-name item-row col-md-10">
                                    <div class="text">Mã</div>
                                    <input class="form-control" th:field="*{ma}" readonly/>
                                </div>
                                <div class="full-name item-row col-md-10">
                                    <div class="text">Họ tên</div>
                                    <input class="form-control" th:field="*{ten}"/>
                                </div>
                                <div class="email item-row col-md-10">
                                    <div class="text">Email</div>
                                    <input class="form-control" readonly th:field="*{email}"/>

                                </div>
                                <div class="password item-row col-md-10">
                                    <div class="text">Mật khẩu</div>
                                    <div class="password-wrapper">
                                        <input class="form-control" type="password" readonly autocomplete="autocomplete"
                                               th:field="*{matKhau}"/>
                                        <a class="change-password text-btn" href="" data-toggle="modal"
                                           data-target="#changePassword">Đổi mật khẩu</a>
                                    </div>
                                </div>
                                <div class="phone item-row col-md-10">
                                    <div class="text">Số điện thoại</div>
                                    <input class="form-control" th:field="*{sdt}"/>
                                </div>
                                <div class="gender item-row col-md-10">
                                    <div class="text">Giới tính</div>
                                    <div class="gender-input-wrapper">
                                        <div class="gender-male-wrapper radio-wrapper">
                                            <input class="male-btn" id="male" type="radio" name="gender" value="NAM"
                                                   th:field="*{gioiTinh}" checked="checked"/>
                                            <label for="male">
                                                <div class="radio-dot"></div>
                                                <div>
                                                    <div class="male">Nam</div>
                                                </div>
                                            </label>
                                        </div>
                                        <div class="gender-female-wrapper radio-wrapper">
                                            <input class="male-btn" id="female" type="radio" name="gender" value="NU"
                                                   th:field="*{gioiTinh}"/>
                                            <label for="female">
                                                <div class="radio-dot"></div>
                                                <div>
                                                    <div class="female">Nữ</div>
                                                </div>
                                            </label>
                                        </div>
                                        <div class="gender-other-wrapper radio-wrapper">
                                            <input class="male-btn" id="other" type="radio" name="gender"/>
                                        </div>
                                    </div>
                                </div>
                                <div class="update-btn-wrapper item-row col-md-10">
                                    <button type="submit" class="btn btn-primary black-btn " style="margin: auto">Lưu
                                        Thay Đổi
                                    </button>
                                </div>
                            </form>
                        </div>
                        <!-- address-setting Section-->
                        <div class="tab-pane fade" id="address-setting" role="tabpanel"
                             aria-labelledby="address-setting-tab">
                            <!-- Item-->
                            <div style="max-height: 400px;overflow-y: auto;">
                                <div class="setting-box">
                                    <div class="address-item">
                                        <div class="header diaChiRow" th:each="diaChi, status  : ${listDC}">
                                            <div class="col">
                                                <div class="row">
                                                    <h6 style="margin-top: auto" class="card-subtitle mb-2 text-muted"
                                                        th:text="${diaChi.tenNguoiNhan}" id="nguoiNhan"></h6>
                                                </div>
                                                <div class="row">
                                                    <p class="phone" th:text="${diaChi.sdt}"></p>
                                                </div>
                                                <div style="display: flex;flex-wrap: wrap;">
                                                    <p class="card-text" th:text="${diaChi.diaChi}"></p>
                                                    <p th:id="${diaChi.phuongXa}" class="phuongXaColumn"></p>
                                                    <p th:id="${diaChi.quanHuyen}" class="quanHuyenColumn"></p>
                                                    <p th:id="${diaChi.thanhPho}" class="thanhPhoColumn"></p>
                                                </div>
                                                <hr style="width: 50%;">
                                            </div>

                                            <div class="edit-address text-btn" data-bs-toggle="modal"
                                                 th:data-bs-target="'#suaDiaChi' + ${diaChi.id}"
                                                 data-target="#addNewShipping">
                                                Cập nhật
                                            </div>
                                            <div style="margin-left: 2%">
                                                <a th:data-bs-target="'#xoaDiaChi' + ${diaChi.id}"
                                                   data-bs-toggle="modal"
                                                   class="edit-address text-btn">
                                                    Xoá
                                                </a>
                                                <div class="modal fade" th:id="'xoaDiaChi' + ${diaChi.id}"
                                                     data-bs-backdrop="static" data-bs-keyboard="false"
                                                     aria-hidden="true"
                                                     aria-labelledby="xoaSanPhamLabel" tabindex="-1">
                                                    <form th:action="@{'/haven/delete-dia-chi/' + ${diaChi.id} + '/'+${khachHang.id}}">
                                                        <div class="modal-dialog modal-dialog-centered">
                                                            <div class="modal-content">
                                                                <div class="modal-header"
                                                                     style="background-color: #314d43;color: #ffff">
                                                                    <h1 class="modal-title fs-5"
                                                                        id="xoaSanPhamLabel">Xác nhận</h1>
                                                                    <button type="button" class="btn-close"
                                                                            data-bs-dismiss="modal"
                                                                            aria-label="Close"></button>
                                                                </div>
                                                                <div class="modal-body" style="text-align: center">
                                                                    Xác nhận xóa địa chỉ(Không/Có)?
                                                                </div>
                                                                <div class="modal-footer">
                                                                    <button type="button"
                                                                            class="btn btn-danger"
                                                                            data-bs-dismiss="modal">
                                                                        Không
                                                                    </button>
                                                                    <button type="submit"
                                                                            class="btn btn-primary">
                                                                        Có
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </form>
                                                </div>
                                            </div>
                                            <form id="myFormUpdate"
                                                  th:action="@{'/haven/update-dia-chi/' + ${diaChi.id} + '/'+${khachHang.id}}"
                                                  method="post" class="my-form reduced-height"
                                                  onsubmit="return validateUpdateDiaChi(event)">
                                                <div class="modal fade" th:id="'suaDiaChi' + ${diaChi.id}"
                                                     data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
                                                     aria-labelledby="staticBackdropLabel" aria-hidden="true">
                                                    <div class="modal-dialog modal-dialog-scrollable">
                                                        <div class="modal-content">
                                                            <div class="modal-header"
                                                                 style="background-color: #314d43;color: #ffff">
                                                                <h1 class="modal-title fs-5" id="staticBackdropLabel">
                                                                    Thay Đổi Địa Chỉ
                                                                </h1>
                                                                <button aria-label="Close" class="btn-close"
                                                                        data-bs-dismiss="modal" type="button"></button>
                                                            </div>
                                                            <div class="modal-body">
                                                                <input hidden th:value="${diaChi.id}"/>
                                                                <label class="form-label">Tên Người Nhận:</label>
                                                                <input type="text" class="form-control mb-3"
                                                                       id="tenNguoiNhanUpdate" name="tenNguoiNhan"
                                                                       th:value="${diaChi.tenNguoiNhan}"/>
                                                                <span class="check-loi" id="checkLoiNguoiNhanUpdate"
                                                                      style="display: none;color: red"></span>
                                                                <label class="form-label">Số điện thoại:</label>
                                                                <input type="text" class="form-control mb-3" name="sdt"
                                                                       id="sdtUpdate" th:value="${diaChi.sdt}"/>
                                                                <span class="check-loi" id="checkLoiSDTUpdate"
                                                                      style="display: none;color: red"></span>
                                                                <div class="mb-3">
                                                                    <label class="col-form-label">Chọn
                                                                        Tỉnh/Thành Phố:</label>
                                                                    <select th:id="${'citySelect'+status.index}"
                                                                            name="thanhPho" class="form-select"
                                                                            aria-label="Default select example">
                                                                        <option value="">Chọn Tỉnh/Thành Phố</option>
                                                                    </select>
                                                                    <span class="check-loi" id="checkLoiThanhPhoUpdate"
                                                                          style="display: none;color: red"></span>
                                                                </div>
                                                                <div class="mb-3">
                                                                    <label class="col-form-label">Chọn
                                                                        Huyện/Quận:</label>
                                                                    <select th:id="${'districtSelect'+status.index}"
                                                                            name="quanHuyen" class="form-select"
                                                                            aria-label="Default select example">
                                                                        <option value="">Chọn Huyện/Quận</option>
                                                                    </select>
                                                                    <span class="check-loi" id="checkLoiQuanHuyenUpdate"
                                                                          style="display: none;color: red"></span>
                                                                </div>
                                                                <div class="mb-3">
                                                                    <label class="col-form-label">Chọn
                                                                        Xã/Phường:</label>
                                                                    <select th:id="${'wardSelect'+status.index}"
                                                                            name="phuongXa" class="form-select"
                                                                            aria-label="Default select example">
                                                                        <option value="">Chọn Xã/Phường</option>
                                                                    </select>
                                                                    <span class="check-loi" id="checkLoiPhuongXaUpdate"
                                                                          style="display: none;color: red"></span>
                                                                </div>
                                                                <div id="customAlert" class="text-danger"></div>
                                                                <div class="mb-3">
                                                                    <label class="form-label">Địa chỉ cụ thể:</label>
                                                                    <input type="text" class="form-control mb-3"
                                                                           id="diaChiUpdate" name="diaChi"
                                                                           th:value="${diaChi.diaChi}"/>
                                                                    <span class="check-loi" id="checkLoiDCUTpdate"
                                                                          style="display: none;color: red"></span>
                                                                </div>
                                                                <div class="mb-3">
                                                                    <label class="form-label">Ghi chú:</label>
                                                                    <input type="text" class="form-control mb-3"
                                                                           name="ghiChu"
                                                                           th:value="${diaChi.ghiChu}"/>
                                                                </div>
                                                                <!-- New alert message container -->
                                                                <div class="modal-footer">
                                                                    <button type="button" class="btn btn-danger"
                                                                            data-bs-dismiss="modal">Đóng
                                                                    </button>
                                                                    <button type="submit" class="btn btn-primary">Xác
                                                                        Nhận
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </form>
                                            <script th:inline="javascript">
                                                function validateUpdateDiaChi(event) {
                                                    event.preventDefault();
                                                    var nameForm = 'myFormUpdate';
                                                    var index = [[${status.index}]];
                                                    var formElement = document.getElementById(nameForm);
                                                    var formData = new FormData(formElement);

                                                    var isValid = true; // Biến để theo dõi trạng thái tổng thể


                                                    var tenNguoiNhanCheck = document.getElementById('tenNguoiNhanUpdate');
                                                    var checkLoitenNguoiNhanUpdate = document.getElementById('checkLoiNguoiNhanUpdate');
                                                    checkLoitenNguoiNhanUpdate.style.display = 'none'
                                                    if (tenNguoiNhanCheck.value.trim() == '') {
                                                        checkLoitenNguoiNhanUpdate.innerHTML = ''
                                                        checkLoitenNguoiNhanUpdate.style.display = 'block'
                                                        checkLoitenNguoiNhanUpdate.innerText = "Chưa nhập địa chỉ cụ thể"
                                                        isValid = false
                                                    }


                                                    var sdtCheck = document.getElementById('sdtUpdate');
                                                    var checkLoiSDTUpdate = document.getElementById('checkLoiSDTUpdate');
                                                    checkLoiSDTUpdate.style.display = 'none'
                                                    if (sdtCheck.value.trim() == '') {
                                                        checkLoiSDTUpdate.innerHTML = ''
                                                        checkLoiSDTUpdate.style.display = 'block'
                                                        checkLoiSDTUpdate.innerText = "Chưa nhập địa chỉ cụ thể"
                                                        isValid = false
                                                    }

                                                    var districtSelectUpdateCheck = document.getElementById('districtSelect' + index);
                                                    console.log("idThanhPho: " + districtSelectUpdateCheck);
                                                    var checkLoiThanhPhoUpdate = document.getElementById('checkLoiThanhPhoUpdate');
                                                    checkLoiThanhPhoUpdate.style.display = 'none'
                                                    if (districtSelectUpdateCheck.value == '') {
                                                        checkLoiThanhPhoUpdate.innerHTML = ''
                                                        checkLoiThanhPhoUpdate.style.display = 'block'
                                                        checkLoiThanhPhoUpdate.innerText = "Chưa chọn Tỉnh/Thành phố"
                                                        isValid = false
                                                    }

                                                    var districtSelectUpdateCheck = document.getElementById('districtSelect' + index);
                                                    console.log("idThanhPho: " + districtSelectUpdateCheck);
                                                    var checkLoiQuanHuyenUpdate = document.getElementById('checkLoiQuanHuyenUpdate');
                                                    checkLoiQuanHuyenUpdate.style.display = 'none'
                                                    if (districtSelectUpdateCheck.value == '') {
                                                        console.log("Chưa chọn quận/huyện")
                                                        checkLoiQuanHuyenUpdate.innerHTML = ''
                                                        checkLoiQuanHuyenUpdate.style.display = 'block'
                                                        checkLoiQuanHuyenUpdate.innerText = "Chưa chọn quận/huyện"
                                                        isValid = false
                                                    }

                                                    var wardSelectUpdateCheck = document.getElementById('wardSelect' + index);
                                                    var checkLoiPhuongXaUpdate = document.getElementById('checkLoiPhuongXaUpdate');
                                                    checkLoiPhuongXaUpdate.style.display = 'none'
                                                    if (wardSelectUpdateCheck.value.trim() == '') {
                                                        checkLoiPhuongXaUpdate.innerHTML = ''
                                                        checkLoiPhuongXaUpdate.style.display = 'block'
                                                        checkLoiPhuongXaUpdate.innerText = "Chưa chọn phường/xã"
                                                        isValid = false
                                                    }


                                                    var diaChiCuTheCheck = document.getElementById('diaChiUpdate');
                                                    var checkLoiDCCTUpdate = document.getElementById('checkLoiDCUTpdate');
                                                    checkLoiDCCTUpdate.style.display = 'none'
                                                    if (diaChiCuTheCheck.value.trim() == '') {
                                                        checkLoiDCCTUpdate.innerHTML = ''
                                                        checkLoiDCCTUpdate.style.display = 'block'
                                                        checkLoiDCCTUpdate.innerText = "Chưa nhập địa chỉ cụ thể"
                                                        isValid = false
                                                    }

                                                    if (isValid) {
                                                        fetch(formElement.action, {
                                                            method: 'POST',
                                                            body: formData
                                                        })
                                                            .then(response => {
                                                                if (!response.ok) {
                                                                    throw new Error('Network response was not ok');
                                                                }
                                                                // Nếu muốn xử lý dữ liệu trả về từ máy chủ, thêm logic xử lý ở đây
                                                                // ...

                                                                // Load lại trang hiện tại sau khi gửi dữ liệu thành công
                                                                location.reload();
                                                            })
                                                            .catch(error => {
                                                                console.error('There was a problem with the fetch operation:', error);
                                                                // Xử lý lỗi nếu cần thiết
                                                            });
                                                    }

                                                    console.log("thành công")

                                                }
                                            </script>
                                            <!-- detail api địa chỉ-->
                                            <script th:inline="javascript">
                                                document.addEventListener('DOMContentLoaded', function () {
                                                    var citySelect = document.getElementById(/*[[ ${'citySelect'+status.index} ]]*/ '');
                                                    var districtSelect = document.getElementById(/*[[ ${'districtSelect'+status.index} ]]*/ '');
                                                    var wardSelect = document.getElementById(/*[[ ${'wardSelect'+status.index} ]]*/ '');
                                                    var selectedCityValue = /*[[ ${diaChi.thanhPho} ]]*/ '';
                                                    var selectedDistrictValue = /*[[ ${diaChi.quanHuyen} ]]*/ '';
                                                    var selectedWardValue = /*[[ ${diaChi.phuongXa} ]]*/ '';

                                                    fetch('https://online-gateway.ghn.vn/shiip/public-api/master-data/province', {
                                                        method: 'GET',
                                                        headers: {
                                                            'token': 'd900c67f-742d-11ee-96dc-de6f804954c9',
                                                            'Content-Type': 'application/json',
                                                        },
                                                    })
                                                        .then(response => response.json())
                                                        .then(data => {
                                                            // Xử lý dữ liệu khi API trả về thành công
                                                            populateSelect(citySelect, data.data, 'ProvinceID', 'ProvinceName');

                                                            // Tìm option có giá trị là selectedCityValue và đặt nó làm được chọn
                                                            var selectedOption = citySelect.querySelector(`option[value="${selectedCityValue}"]`);
                                                            if (selectedOption) {
                                                                selectedOption.selected = true;
                                                                // Kiểm tra nếu giá trị thành phố đã được chọn
                                                                if (selectedCityValue) {
                                                                    // Gọi hàm để tải và populate quận/huyện dựa trên ID của thành phố
                                                                    populateDistricts(selectedCityValue);
                                                                }
                                                            }

                                                        })
                                                        .catch(error => {
                                                            console.error('Lỗi khi tải dữ liệu thành phố:', error);
                                                        });

                                                    // Sự kiện khi chọn thành phố
                                                    citySelect.addEventListener('change', function () {
                                                        // Lấy ID của thành phố đã chọn
                                                        var selectedCityId = this.value;

                                                        console.log(selectedCityId);
                                                        // Kiểm tra nếu giá trị thành phố đã được chọn
                                                        if (selectedCityId) {
                                                            // Xóa hết các quận/huyện hiện tại trước khi tải mới
                                                            districtSelect.innerHTML = '<option value="">Chọn quận/huyện</option>';
                                                            // Gọi hàm để tải và populate quận/huyện dựa trên ID của thành phố
                                                            populateDistricts(selectedCityId);
                                                        }
                                                    });

                                                    // Sự kiện khi chọn quận
                                                    districtSelect.addEventListener('change', function () {
                                                        // Lấy ID của quận đã chọn
                                                        var selectedDistrictId = this.value;

                                                        console.log(selectedDistrictId);
                                                        // Kiểm tra nếu giá trị quận đã được chọn
                                                        if (selectedDistrictId) {
                                                            // Xóa hết các quận/huyện hiện tại trước khi tải mới
                                                            wardSelect.innerHTML = '<option value="">Chọn xã/phường</option>';
                                                            // Gọi hàm để tải và populate quận/huyện dựa trên ID của thành phố
                                                            populateWard(selectedDistrictId);
                                                        }
                                                    });

                                                    // Hàm để tải và populate quận/huyện
                                                    function populateDistricts(selectedCityId) {
                                                        fetch(`https://online-gateway.ghn.vn/shiip/public-api/master-data/district?province_id=${selectedCityId}`, {
                                                            method: 'GET',
                                                            headers: {
                                                                'token': 'd900c67f-742d-11ee-96dc-de6f804954c9',
                                                                'Content-Type': 'application/json',
                                                            },
                                                        })
                                                            .then(response => response.json())
                                                            .then(data => {
                                                                // Xử lý dữ liệu khi API trả về thành công
                                                                populateSelect(districtSelect, data.data, 'DistrictID', 'DistrictName');

                                                                // Tìm option có giá trị là selectedCityValue và đặt nó làm được chọn
                                                                var selectedOption = districtSelect.querySelector(`option[value="${selectedDistrictValue}"]`);
                                                                if (selectedOption) {
                                                                    selectedOption.selected = true;
                                                                    // Kiểm tra nếu giá trị thành phố đã được chọn
                                                                    if (selectedDistrictValue) {
                                                                        // Gọi hàm để tải và populate quận/huyện dựa trên ID của thành phố
                                                                        populateWard(selectedDistrictValue);
                                                                    }
                                                                }

                                                            })
                                                            .catch(error => {
                                                                console.error('Lỗi khi tải dữ liệu quận:', error);
                                                            });
                                                    }

                                                    // Hàm để tải và populate xã phường
                                                    function populateWard(selectedDistrictId) {
                                                        fetch(`https://online-gateway.ghn.vn/shiip/public-api/master-data/ward?district_id=${selectedDistrictId}`, {
                                                            method: 'GET',
                                                            headers: {
                                                                'token': 'd900c67f-742d-11ee-96dc-de6f804954c9',
                                                                'Content-Type': 'application/json',
                                                            },
                                                        })
                                                            .then(response => response.json())
                                                            .then(data => {
                                                                // Xử lý dữ liệu khi API trả về thành công
                                                                populateSelect(wardSelect, data.data, 'WardCode', 'WardName');

                                                                // Tìm option có giá trị là selectedCityValue và đặt nó làm được chọn
                                                                var selectedOption = wardSelect.querySelector(`option[value="${selectedWardValue}"]`);
                                                                if (selectedOption) {
                                                                    selectedOption.selected = true;
                                                                }

                                                            })
                                                            .catch(error => {
                                                                console.error('Lỗi khi tải dữ liệu xã:', error);
                                                            });
                                                    }

                                                    // Hàm để populate dropdown
                                                    function populateSelect(select, data, idKey, textKey) {
                                                        // select.innerHTML = '<option value="">Chọn thành phố</option>';
                                                        data.forEach(item => {
                                                            var option = document.createElement('option');
                                                            option.value = item[idKey];
                                                            option.text = item[textKey];
                                                            select.appendChild(option);
                                                        });
                                                    }
                                                });
                                            </script>
                                            <!-- detail api địa chỉ end-->
                                        </div>
                                        <!-- detail api địa chỉ lên bảng-->
                                        <script th:inline="javascript">
                                            document.addEventListener('DOMContentLoaded', function () {
                                                fetch('https://online-gateway.ghn.vn/shiip/public-api/master-data/province', {
                                                    method: 'GET',
                                                    headers: {
                                                        'token': 'd900c67f-742d-11ee-96dc-de6f804954c9',
                                                        'Content-Type': 'application/json',
                                                    },
                                                })
                                                    .then(response => response.json())
                                                    .then(data => {
                                                        // Lấy giá trị id thành phố từ thymeleaf
                                                        var idThanhPhoArray = /*[[ ${listDC.![thanhPho] }]]*/ [];

                                                        // Duyệt qua mỗi dòng trong bảng
                                                        document.querySelectorAll('.diaChiRow').forEach((row, index) => {
                                                            // Lấy id thành phố cho dòng hiện tại
                                                            var idThanhPho = idThanhPhoArray[index];

                                                            // Tìm thành phố trong data.data dựa trên id
                                                            var thanhPho = data.data.find(city => city.ProvinceID == idThanhPho);

                                                            // Đặt tên thành phố vào thẻ có class là thanhPhoColumn trong dòng hiện tại
                                                            var thanhPhoColumn = row.querySelector('.thanhPhoColumn');
                                                            if (thanhPhoColumn && thanhPho) {
                                                                thanhPhoColumn.innerText = ' , ' + thanhPho.ProvinceName;
                                                            }
                                                        });
                                                    })
                                                    .catch(error => {
                                                        console.error('Lỗi khi tải dữ liệu thành phố:', error);
                                                    });

                                                // Hàm để tải và populate quận/huyện
                                                fetch(`https://online-gateway.ghn.vn/shiip/public-api/master-data/district`, {
                                                    method: 'GET',
                                                    headers: {
                                                        'token': 'd900c67f-742d-11ee-96dc-de6f804954c9',
                                                        'Content-Type': 'application/json',
                                                    },
                                                })
                                                    .then(response => response.json())
                                                    .then(data => {
                                                        // Lấy giá trị id thành phố từ thymeleaf
                                                        var idQuanHuyenArray = /*[[ ${listDC.![quanHuyen] }]]*/ [];
                                                        // Duyệt qua mỗi dòng trong bảng
                                                        document.querySelectorAll('.diaChiRow').forEach((row, index) => {
                                                            // Lấy id thành phố cho dòng hiện tại
                                                            var idQuanHuyen = idQuanHuyenArray[index];

                                                            // Tìm thành phố trong data.data dựa trên id
                                                            var quanHuyen = data.data.find(district => district.DistrictID == idQuanHuyen);

                                                            // Đặt tên thành phố vào thẻ có class là quanHuyenColumn trong dòng hiện tại
                                                            var quanHuyenColumn = row.querySelector('.quanHuyenColumn');
                                                            if (quanHuyenColumn && quanHuyen) {
                                                                quanHuyenColumn.innerText = ' , ' + quanHuyen.DistrictName;
                                                            }
                                                        });
                                                    })
                                                    .catch(error => {
                                                        console.error('Lỗi khi tải dữ liệu quận:', error);
                                                    });


                                                // Lấy danh sách id quận/huyện từ một danh sách district
                                                var idQuanHuyenArray = /*[[ ${listDC.![quanHuyen] }]]*/ [];
                                                // Lặp qua từng id quận/huyện và gọi API cho mỗi id
                                                idQuanHuyenArray.forEach(idQuanHuyen => {
                                                    fetch(`https://online-gateway.ghn.vn/shiip/public-api/master-data/ward?district_id=${idQuanHuyen}`, {
                                                        method: 'GET',
                                                        headers: {
                                                            'token': 'd900c67f-742d-11ee-96dc-de6f804954c9',
                                                            'Content-Type': 'application/json',
                                                        },
                                                    })
                                                        .then(response => response.json())
                                                        .then(data => {
                                                            // Lấy giá trị id thành phố từ thymeleaf
                                                            var idPhuongXaArray = /*[[ ${listDC.![phuongXa] }]]*/ [];
                                                            // Duyệt qua mỗi dòng trong bảng
                                                            document.querySelectorAll('.diaChiRow').forEach((row, index) => {
                                                                // Lấy id thành phố cho dòng hiện tại
                                                                var idPhuongXa = idPhuongXaArray[index];

                                                                // Tìm thành phố trong data.data dựa trên id
                                                                var phuongXa = data.data.find(ward => ward.WardCode == idPhuongXa);
                                                                console.log(phuongXa)

                                                                // Đặt tên thành phố vào thẻ có class là phuongXaColumn trong dòng hiện tại
                                                                var phuongXaColumn = row.querySelector('.phuongXaColumn');
                                                                if (phuongXaColumn && phuongXa) {
                                                                    phuongXaColumn.innerText = ' , ' + phuongXa.WardName;
                                                                }

                                                            });
                                                        })
                                                        .catch(error => {
                                                            console.error('Lỗi khi tải dữ liệu xã:', error);
                                                        });
                                                });
                                            });

                                        </script>
                                        <!-- detail api địa chỉ end-->
                                    </div>
                                </div>
                            </div>

                            <div>
                                <button class="btn btn-primary black-btn " data-toggle="modal"
                                        data-target="#addNewShipping10"
                                        onclick="apiAddDiaChi(event)">
                                    + Thêm Địa Mới
                                </button>
                            </div>
                            <!--   Modal thêm địa chỉ  -->
                            <form id="myFormAdd" th:action="@{'/haven/add-dia-chi/'+${khachHang.id}}"
                                  th:object="${diaChi}" method="post"
                                  onsubmit="return validateAdd(event)">
                                <div class="modal fade" id="addNewShipping10" data-bs-backdrop="static"
                                     data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel"
                                     aria-hidden="true">
                                    <div class="modal-dialog modal-dialog-scrollable">
                                        <div class="modal-content">
                                            <div class="modal-header" style="background-color: #314d43;color: #ffff">
                                                <h1 class="modal-title fs-5" id="addNewShippingLabel">Thêm Địa Chỉ
                                                    Mới</h1>
                                                <button aria-label="Close" class="btn-close"
                                                        data-bs-dismiss="modal"
                                                        type="button"></button>
                                            </div>
                                            <div class="modal-body">
                                                <div class="mb-3">
                                                    <label class="col-form-label">
                                                        Tên người nhận:
                                                    </label>
                                                    <input class="form-control full-name" placeholder="Họ và tên"
                                                           id="tenNguoiNhan" name="tenNguoiNhan"
                                                           th:field="*{tenNguoiNhan}"/>
                                                    <span class="check-loi" id="checkLoiNguoiNhanAdd"
                                                          style="display: none;color: red"></span>
                                                    <div class="invalid-feedback" th:field="${tenNguoiNhan}"></div>
                                                </div>
                                                <div class="mb-3">
                                                    <label class="col-form-label">Số
                                                        điện thoại:</label>
                                                    <input type="text" class="form-control"
                                                           placeholder="Số điện thoại" id="SDT" name="sdt"
                                                           th:field="*{sdt}">
                                                    <span class="check-loi" id="checkLoiSDTAdd"
                                                          style="display: none;color: red"></span>
                                                </div>
                                                <div class="mb-3">
                                                    <label class="col-form-label">Chọn
                                                        Tỉnh/Thành Phố:</label>
                                                    <select id="citySelectAdd"
                                                            name="thanhPhoID" class="form-select"
                                                            aria-label="Default select" p>
                                                        <option value="">Chọn Tỉnh/Thành Phố</option>
                                                    </select>
                                                    <span class="check-loi" id="checkLoiThanhPhoAdd"
                                                          style="display: none;color: red"></span>
                                                </div>
                                                <div class="mb-3">
                                                    <label class="col-form-label">Chọn
                                                        Huyện/Quận:</label>
                                                    <select id="districtSelectAdd"
                                                            name="quanHuyenID" class="form-select"
                                                            aria-label="Default select">
                                                        <option value="">Chọn Huyện/Quận</option>
                                                    </select>
                                                    <span class="check-loi" id="checkLoiQuanHuyenAdd"
                                                          style="display: none;color: red"></span>
                                                </div>
                                                <div class="mb-3">
                                                    <label class="col-form-label">Chọn
                                                        Xã/Phường:</label>
                                                    <select id="wardSelectAdd"
                                                            name="phuongXaID" class="form-select"
                                                            aria-label="Default select">
                                                        <option value="">Chọn Xã/Phường</option>
                                                    </select>
                                                    <span class="check-loi" id="checkLoiPhuongXaAdd"
                                                          style="display: none;color: red"></span>
                                                </div>
                                                <div class="mb-3">
                                                    <label class="col-form-label">
                                                        Địa chỉ cụ thể:
                                                    </label>
                                                    <input class="form-control address" placeholder="Địa chỉ cụ thể"
                                                           id="diaChi" th:field="*{diaChi}"/>
                                                    <span class="check-loi" id="checkLoiDCCTAdd"
                                                          style="display: none;color: red"></span>
                                                </div>
                                                <div class="mb-3">
                                                    <label class="col-form-label">
                                                        Ghi chú:
                                                    </label>
                                                    <input class="form-control ghiChu" placeholder="Ghi chú"
                                                           id="ghiChu" th:field="*{ghiChu}"/>
                                                    <span class="check-loi" id="checkLoiGhiChuAdd"
                                                          style="display: none;color: red"></span>
                                                </div>
                                            </div>
                                            <div class="modal-footer">
                                                <button class="btn" type="button" data-dismiss="modal">
                                                    Huỷ bỏ
                                                </button>
                                                <button class="btn btn-primary black-btn save" type="submit">
                                                    Lưu
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>
                            <!--   Thêm địa chỉ end  -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal -->
    <div class="modal fade" id="changePassword" tabindex="-1" role="dialog" aria-labelledby="changePasswordLabel"
         aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Đổi mật khẩu</h5>
                </div>
                <div class="modal-body">
                    <form th:action="@{/haven/change-password}" method="post">
                        <div class="current-password item-row">
                            <div class="text">Mật khẩu cũ</div>
                            <div class="password-wrapper">
                                <input class="form-control" th:value="${oldPassword}" name="oldPassword" type="password"
                                       autocomplete="autocomplete"/>
                            </div>
                        </div>
                        <div class="new-password item-row">
                            <div class="text">Mật khẩu mới</div>
                            <input type="hidden" id="id" name="id" th:value="${khachHang.id}">

                            <div class="password-wrapper">
                                <input class="form-control" id="newPasswordInput" th:value="${newPassword}"
                                       name="newPassword" type="password" autocomplete="autocomplete"/>
                            </div>
                        </div>
                        <div class="new-password-confirm item-row">
                            <div class="text">Nhập lại mật khẩu mới</div>
                            <div class="password-wrapper">
                                <input id="confirmNewPasswordInput" class="form-control" type="password"
                                       autocomplete="autocomplete"/>
                            </div>
                            <div id="passwordMismatchMessage" style="color: red; display: none;">Mật khẩu không khớp.
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn" type="button" data-dismiss="modal">Huỷ bỏ</button>
                            <button id="submitButton" class="btn btn-primary black-btn" type="submit">Lưu</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

    </div>

</main>


<!-- Start Footer Section -->
<footer class="footer-section">
    <div class="container relative">

        <div class="row g-5 mb-5">
            <div class="col-lg-4">
                <div class="mb-4 footer-logo-wrap"><a href="#" class="footer-logo">Haven<span>.</span></a></div>
                <p class="mb-4">Cảm ơn bạn đã tin tưởng ghé qua và lựa chọn Haven.</p>

                <ul class="list-unstyled custom-social">
                    <li><a href="#"><span class="fa fa-brands fa-facebook-f"></span></a></li>
                    <li><a href="#"><span class="fa fa-brands fa-twitter"></span></a></li>
                    <li><a href="#"><span class="fa fa-brands fa-instagram"></span></a></li>
                    <li><a href="#"><span class="fa fa-brands fa-linkedin"></span></a></li>
                </ul>
            </div>

            <div class="col-lg-8">
                <div class="row links-wrap">
                    <div class="col-6 col-sm-6 col-md-3">
                        <ul class="list-unstyled">
                            <li><a href="#">Liên hệ</a></li>
                            <li><a href="#">Dịch vụ</a></li>
                            <li><a href="#">Thông tin</a></li>
                            <li><a href="#">Trung tâm trợ giúp</a></li>
                        </ul>
                    </div>

                    <div class="col-6 col-sm-6 col-md-3">
                        <ul class="list-unstyled">
                            <li><a href="#">Vận chuyển</a></li>
                            <li><a href="#">Khu vực</a></li>
                            <li><a href="#">Kênh bán hàng</a></li>
                        </ul>
                    </div>

                    <div class="col-6 col-sm-6 col-md-3">
                        <ul class="list-unstyled">
                            <li><a href="#">Hướng dẫn mua hàng</a></li>
                            <li><a href="#">Đội ngũ</a></li>
                            <li><a href="#">Trả hàng</a></li>
                            <li><a href="#">Bảo mật</a></li>
                        </ul>
                    </div>

                    <div class="col-6 col-sm-6 col-md-3">
                        <ul class="list-unstyled">
                            <li><a href="#">Chăm sóc khách hàng</a></li>
                            <li><a href="#">Chính sách bảo hành</a></li>
                            <li><a href="#">Hoàn tiền</a></li>
                        </ul>
                    </div>
                </div>
            </div>

        </div>

        <div class="border-top copyright">
            <div class="row pt-4">
                <div class="col-lg-6">
                    <p class="mb-2 text-center text-lg-start">Chủ sở hữu &copy;
                        <script>document.write(new Date().getFullYear());</script> &mdash;
                        Thiết kế tâm huyết của nhóm <a href="">SD-05</a> <a hreff=""></a>
                        <!-- License information: https://untree.co/license/ -->
                    </p>
                </div>

                <div class="col-lg-6 text-center text-lg-end">
                    <ul class="list-unstyled d-inline-flex ms-auto">
                        <li class="me-4"><a href="#">Dự án tốt nghiệp: </a></li>
                        <li><a href="#">Xây dựng Website bán giày thể thao Haven</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</footer>
<script>
    new DataTable('#example');
</script>
<script src='https://code.jquery.com/jquery-3.7.0.js'></script>
<script src='https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js'></script>
<script src='https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js'></script>
<script type="text/javascript" src="./vendor/jquery/jquery-3.4.1.min.js"></script>
<script type="text/javascript" src="./vendor/jquery/jquery-3.4.1.min.js"></script>
<script type="text/javascript" src="./vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<!-- Main Js-->
<script type="text/javascript" src="/../js/customer/user/main.js"></script>
<!-- Card-->
<script type="text/javascript" src="/../js/customer/user/jquery.card.js"></script>
<script src="/../js/customer/user/except-home-page.js"></script>
<script src="/../js/customer/user/address-select.js"></script>
<script src="/../js/customer/user/account.js"></script>
<script src="/../js/customer/bootstrap.bundle.min.js"></script>
<script src="/../js/customer/tiny-slider.js"></script>
<script src="/../js/customer/custom.js"></script>
<script>
    const newPasswordInput = document.getElementById('newPasswordInput');
    const confirmNewPasswordInput = document.getElementById('confirmNewPasswordInput');
    const passwordMismatchMessage = document.getElementById('passwordMismatchMessage');
    const submitButton = document.getElementById('submitButton');

    confirmNewPasswordInput.addEventListener('input', function () {
        const newPassword = newPasswordInput.value;
        const confirmedPassword = confirmNewPasswordInput.value;

        if (newPassword !== confirmedPassword) {
            passwordMismatchMessage.style.display = 'block';
            submitButton.disabled = true;
        } else {
            passwordMismatchMessage.style.display = 'none';
            submitButton.disabled = false;
        }
    });
</script>
<!-- Main Js-->
<script>
    $(document).ready(function () {
        $('#example').DataTable();
    })

</script>
<script>
    function updateTrangThai(index) {
        var defaultCheck = 'defaultCheck' + index
        var trangThaiHidden = 'trangThaiHidden' + index

        var checkbox = document.getElementById(defaultCheck);
        var trangThaiHidden = document.getElementById(trangThaiHidden);

        // Nếu checkbox được chọn, thiết lập giá trị của input hidden là 0
        // Ngược lại, giữ giá trị là 1
        trangThaiHidden.value = checkbox.checked ? '1' : '0';
        trangThaiHidden.value = checkbox.checked ? '0' : '1';
    }

    function buttonDong() {
        location.reload();
    }

    function submitFormAndReload(event, index) {
        event.preventDefault(); // Prevent the default form submission behavior
        var nameForm = 'myForm' + index
        var formElement = document.getElementById(nameForm);
        var formData = new FormData(formElement);

        var isValid = true; // Biến để theo dõi trạng thái tổng thể

        for (var stt = 0; stt < 5; stt++) {
            var districtSelectUpdateCheck = document.getElementById('districtSelect' + stt);
            var checkLoiQuanHuyenUpdate = document.getElementById('checkLoiQuanHuyenUpdate' + stt);
            checkLoiQuanHuyenUpdate.style.display = 'none'
            if (districtSelectUpdateCheck.value == '') {
                console.log("Chưa chọn quận/huyện")
                checkLoiQuanHuyenUpdate.innerHTML = ''
                checkLoiQuanHuyenUpdate.style.display = 'block'
                checkLoiQuanHuyenUpdate.innerText = "Chưa chọn quận/huyện"
                isValid = false
            }

            var wardSelectUpdateCheck = document.getElementById('wardSelect' + stt);
            var checkLoiPhuongXaUpdate = document.getElementById('checkLoiPhuongXaUpdate' + stt);
            checkLoiPhuongXaUpdate.style.display = 'none'
            if (wardSelectUpdateCheck.value.trim() == '') {
                checkLoiPhuongXaUpdate.innerHTML = ''
                checkLoiPhuongXaUpdate.style.display = 'block'
                checkLoiPhuongXaUpdate.innerText = "Chưa chọn phường/xã"
                isValid = false
            }

            var diaChiCuTheCheck = document.getElementById('c_addresUpdate' + stt);
            var checkLoiDCCTUpdate = document.getElementById('checkLoiDCCTUpdate' + stt);
            checkLoiDCCTUpdate.style.display = 'none'
            if (diaChiCuTheCheck.value.trim() == '') {
                checkLoiDCCTUpdate.innerHTML = ''
                checkLoiDCCTUpdate.style.display = 'block'
                checkLoiDCCTUpdate.innerText = "Chưa nhập địa chỉ cụ thể"
                isValid = false
            }

            if (isValid) {
                fetch(formElement.action, {
                    method: 'POST',
                    body: formData
                })
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Network response was not ok');
                        }
                        // Nếu muốn xử lý dữ liệu trả về từ máy chủ, thêm logic xử lý ở đây
                        // ...

                        // Load lại trang hiện tại sau khi gửi dữ liệu thành công
                        location.reload();
                    })
                    .catch(error => {
                        console.error('There was a problem with the fetch operation:', error);
                        // Xử lý lỗi nếu cần thiết
                    });
            }
        }
        console.log("thành công")

    }

    function validateAdd(event) {
        event.preventDefault(); // Prevent the default form submission behavior
        var formElement = document.getElementById('myFormAdd');

        // Check spam submit
        var btnThem = event.target.querySelector('button[type="submit"]');
        setTimeout(function () {
            btnThem.disabled = false;
        }, 2000); // 2000 miligiây = 2 giây


        var formData = new FormData(formElement);
        var isValid = true; // Biến để theo dõi trạng thái tổng thể

        var nguoiNhanAddCheck = document.getElementById("tenNguoiNhan");
        var checkLoiNguoiNhanAdd = document.getElementById("checkLoiNguoiNhanAdd");
        if (nguoiNhanAddCheck.value.trim() == '') {
            checkLoiNguoiNhanAdd.innerHTML = ''
            checkLoiNguoiNhanAdd.style.display = 'block'
            checkLoiNguoiNhanAdd.innerText = "Chưa nhập tên người nhận!"
            isValid = false
        }

        var regex = /^0[0-9]{9}$/;
        var sdtAddCheck = document.getElementById("SDT").value;
        console.log("Số điện thoại: " + sdtAddCheck)
        var checkLoiSDTAdd = document.getElementById("checkLoiSDTAdd");
        checkLoiSDTAdd.style.display = 'none'
        if (sdtAddCheck.trim() == '') {
            checkLoiSDTAdd.innerHTML = ''
            checkLoiSDTAdd.style.display = 'block'
            checkLoiSDTAdd.innerText = "Chưa nhập số điện thoại!"
            isValid = false
        } else if (!regex.test(sdtAddCheck)) {
            checkLoiSDTAdd.innerHTML = ''
            checkLoiSDTAdd.style.display = 'block'
            checkLoiSDTAdd.innerText = "Số điện thoại không hợp lệ!"
            isValid = false
        }

        var citySelectAddCheck = document.getElementById("citySelectAdd");
        var checkLoiThanhPhoAdd = document.getElementById("checkLoiThanhPhoAdd");
        checkLoiThanhPhoAdd.style.display = 'none'
        if (citySelectAddCheck.value.trim() == '') {
            checkLoiThanhPhoAdd.innerHTML = ''
            checkLoiThanhPhoAdd.style.display = 'block'
            checkLoiThanhPhoAdd.innerText = "Chưa chọn tỉnh/thành phố"
            isValid = false
        }

        var districtSelectAddCheck = document.getElementById("districtSelectAdd");
        var checkLoiQuanHuyenAdd = document.getElementById("checkLoiQuanHuyenAdd");
        checkLoiQuanHuyenAdd.style.display = 'none'
        if (districtSelectAddCheck.value.trim() == '') {
            checkLoiQuanHuyenAdd.innerHTML = ''
            checkLoiQuanHuyenAdd.style.display = 'block'
            checkLoiQuanHuyenAdd.innerText = "Chưa chọn quận/huyện"
            isValid = false
        }

        var wardSelectAddCheck = document.getElementById("wardSelectAdd");
        var checkLoiPhuongXaAdd = document.getElementById("checkLoiPhuongXaAdd");
        checkLoiPhuongXaAdd.style.display = 'none'
        if (wardSelectAddCheck.value.trim() == '') {
            checkLoiPhuongXaAdd.innerHTML = ''
            checkLoiPhuongXaAdd.style.display = 'block'
            checkLoiPhuongXaAdd.innerText = "Chưa chọn phường/xã"
            isValid = false
        }

        var diaChiCuTheCheck = document.getElementById("diaChi");
        var checkLoiDCCTAdd = document.getElementById("checkLoiDCCTAdd");
        checkLoiDCCTAdd.style.display = 'none'
        if (diaChiCuTheCheck.value.trim() == '') {
            checkLoiDCCTAdd.innerHTML = ''
            checkLoiDCCTAdd.style.display = 'block'
            checkLoiDCCTAdd.innerText = "Chưa nhập địa chỉ cụ thể"
            isValid = false
        }

        var ghiChuCheck = document.getElementById("ghiChu");
        var checkGhiChuAdd = document.getElementById("checkLoiGhiChuAdd");
        checkGhiChuAdd.style.display = 'none'
        if (ghiChuCheck.value.trim() == '') {
            checkGhiChuAdd.innerHTML = ''
            checkGhiChuAdd.style.display = 'block'
            checkGhiChuAdd.innerText = "Chưa nhập địa chỉ cụ thể"
            isValid = false
        }

        if (isValid) {
            fetch(formElement.action, {
                method: 'POST',
                body: formData
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    // Nếu muốn xử lý dữ liệu trả về từ máy chủ, thêm logic xử lý ở đây
                    // ...

                    // Load lại trang hiện tại sau khi gửi dữ liệu thành công
                    location.reload();
                })
                .catch(error => {
                    console.error('There was a problem with the fetch operation:', error);
                    // Xử lý lỗi nếu cần thiết
                });
        }
    }
</script>
<script>
    function apiAddDiaChi(event) {
        var citySelect = document.getElementById('citySelectAdd');
        var districtSelect = document.getElementById('districtSelectAdd');
        var wardSelect = document.getElementById('wardSelectAdd');

        fetch('https://online-gateway.ghn.vn/shiip/public-api/master-data/province', {
            method: 'GET',
            headers: {
                'token': 'd900c67f-742d-11ee-96dc-de6f804954c9',
                'Content-Type': 'application/json',
            },
        })
            .then(response => response.json())
            .then(data => {
                // Xử lý dữ liệu khi API trả về thành công
                populateSelect(citySelect, data.data, 'ProvinceID', 'ProvinceName');
            })
            .catch(error => {
                console.error('Lỗi khi tải dữ liệu thành phố:', error);
            });

        // Sự kiện khi chọn thành phố
        citySelect.addEventListener('change', function () {
            // Lấy ID của thành phố đã chọn
            var selectedCityId = this.value;
            // Kiểm tra nếu giá trị thành phố đã được chọn
            if (selectedCityId) {
                // Xóa hết các quận/huyện hiện tại trước khi tải mới
                districtSelect.innerHTML = '<option value="">Chọn quận/huyện</option>';
                // Gọi hàm để tải và populate quận/huyện dựa trên ID của thành phố
                populateDistricts(selectedCityId);
            }
        });

        // Sự kiện khi chọn quận
        districtSelect.addEventListener('change', function () {
            // Lấy ID của quận đã chọn
            var selectedDistrictId = this.value;

            // Kiểm tra nếu giá trị quận đã được chọn
            if (selectedDistrictId) {
                // Xóa hết các quận/huyện hiện tại trước khi tải mới
                wardSelect.innerHTML = '<option value="">Chọn xã/phường</option>';
                // Gọi hàm để tải và populate quận/huyện dựa trên ID của thành phố
                populateWard(selectedDistrictId);
            }
        });

        // Hàm để tải và populate quận/huyện
        function populateDistricts(selectedCityId) {
            fetch(`https://online-gateway.ghn.vn/shiip/public-api/master-data/district?province_id=${selectedCityId}`, {
                method: 'GET',
                headers: {
                    'token': 'd900c67f-742d-11ee-96dc-de6f804954c9',
                    'Content-Type': 'application/json',
                },
            })
                .then(response => response.json())
                .then(data => {
                    // Xử lý dữ liệu khi API trả về thành công
                    populateSelect(districtSelect, data.data, 'DistrictID', 'DistrictName');
                })
                .catch(error => {
                    console.error('Lỗi khi tải dữ liệu quận:', error);
                });
        }

        // Hàm để tải và populate xã phường
        function populateWard(selectedDistrictId) {
            fetch(`https://online-gateway.ghn.vn/shiip/public-api/master-data/ward?district_id=${selectedDistrictId}`, {
                method: 'GET',
                headers: {
                    'token': 'd900c67f-742d-11ee-96dc-de6f804954c9',
                    'Content-Type': 'application/json',
                },
            })
                .then(response => response.json())
                .then(data => {
                    // Xử lý dữ liệu khi API trả về thành công
                    populateSelect(wardSelect, data.data, 'WardCode', 'WardName');
                })
                .catch(error => {
                    console.error('Lỗi khi tải dữ liệu xã:', error);
                });
        }

        // Hàm để populate dropdown
        function populateSelect(select, data, idKey, textKey) {
            // select.innerHTML = '<option value="">Chọn thành phố</option>';
            data.forEach(item => {
                var option = document.createElement('option');
                option.value = item[idKey];
                option.text = item[textKey];
                select.appendChild(option);
            });
        }
    }
</script>
</body>
</html>